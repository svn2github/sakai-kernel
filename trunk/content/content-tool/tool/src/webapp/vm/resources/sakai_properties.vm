<!-- sakai_properties.vm -->
#if($calendarcounter)<!-- calendarcounter == $calendarcounter -->#else#set($calendarcounter = 0)#end
#if($item && !$model)#set($model = $item)#end
#if(!$item && $model)#set($item = $model)#end

#*
	var calendarcounter = document.calendarcounter++;
	
	var inputfield_id = "chef_calendarhiddenfield"+calendarcounter;

	// The image button that the user clicks on to pop up the calendar 
	document.write('<img src="/library/calendar/images/calendar/cal.gif" onClick="popupCalendar(\''+inputfield_id+'\');" alt="" style="cursor: pointer;" title="Popup date selector" />');

	// A hidden input field where the selected date value will be stored. 
	document.write('<input type="hidden" name="'+inputfield_id+'" id="'+inputfield_id+'" />');

	// stuff away variables specific to this particular calendar instance so that updateXXX() can get them   
	document.calendars[calendarcounter] = new Array(yearselect_id, monthselect_id, dayselect_id, inputfield_id);
*#

#macro (resources_dateselectionwidget $prefix $suffix $current_value)
	#set($yearSelected = $current_value.year)
	#set($earliestYear = $yearSelected - 4)
	#set($latestYear = $yearSelected + 4)
	#set($monthSelected = $current_value.month)
	#set($daySelected = $current_value.day)
	<select name="${prefix}_month${DOT}${suffix}" id="${prefix}_month${DOT}${suffix}">  
    	#if ($monthSelected == 1) <option value="1" selected="selected">$tlang.getString("month.jan")</option> #else <option value="1">$tlang.getString("month.jan")</option> #end
 		#if ($monthSelected == 2) <option value="2" selected="selected">$tlang.getString("month.feb")</option> #else <option value="2">$tlang.getString("month.feb")</option> #end
		#if ($monthSelected == 3) <option value="3" selected="selected">$tlang.getString("month.mar")</option> #else <option value="3">$tlang.getString("month.mar")</option> #end
		#if ($monthSelected == 4) <option value="4" selected="selected">$tlang.getString("month.apr")</option> #else <option value="4">$tlang.getString("month.apr")</option> #end
		#if ($monthSelected == 5) <option value="5" selected="selected">$tlang.getString("month.may")</option> #else <option value="5">$tlang.getString("month.may")</option> #end
		#if ($monthSelected == 6) <option value="6" selected="selected">$tlang.getString("month.jun")</option> #else <option value="6">$tlang.getString("month.jun")</option> #end
		#if ($monthSelected == 7) <option value="7" selected="selected">$tlang.getString("month.jul")</option> #else <option value="7">$tlang.getString("month.jul")</option> #end
		#if ($monthSelected == 8) <option value="8" selected="selected">$tlang.getString("month.aug")</option> #else <option value="8">$tlang.getString("month.aug")</option> #end
		#if ($monthSelected == 9) <option value="9" selected="selected">$tlang.getString("month.sep")</option> #else <option value="9">$tlang.getString("month.sep")</option> #end
		#if ($monthSelected == 10) <option value="10" selected="selected">$tlang.getString("month.oct")</option> #else <option value="10">$tlang.getString("month.oct")</option> #end
		#if ($monthSelected == 11) <option value="11" selected="selected">$tlang.getString("month.nov")</option> #else <option value="11">$tlang.getString("month.nov")</option> #end
		#if ($monthSelected == 12) <option value="12" selected="selected">$tlang.getString("month.dec")</option> #else <option value="12">$tlang.getString("month.dec")</option> #end
    </select>
    <select name="${prefix}_day${DOT}${suffix}" id="${prefix}_day${DOT}${suffix}">
	    #foreach($d in [1..31])
	        #if($d == $daySelected)
	            <option value="$d" selected="selected">$d</option>
	        #else
	            <option value="$d">$d</option>
	        #end
		#end
    </select>
    <select name="${prefix}_year${DOT}${suffix}" id="${prefix}_year${DOT}${suffix}">
        #foreach ($y in [$earliestYear .. $latestYear])
            #if ($y == $yearSelected)
                    <option value="$y" selected="selected">$y</option>
            #else
                    <option value="$y">$y</option>
            #end
		#end
    </select>
    <img id="${prefix}_calendar${DOT}${suffix}" src="/library/calendar/images/calendar/cal.gif" alt="" style="cursor: pointer;" title="Popup date selector" />
    <input type="hidden" name="chef_calendarhiddenfield${calendarcounter}" id="chef_calendarhiddenfield${calendarcounter}" />
	#set($cValue = $calendarMap.put("$calendarcounter", ["${prefix}_year${DOT}${suffix}", "${prefix}_month${DOT}${suffix}", "${prefix}_day${DOT}${suffix}", "chef_calendarhiddenfield${calendarcounter}"]))
	#set($calendarcounter = $calendarcounter + 1)
#end

#macro(resources_timeSelectionWidget $prefix $suffix $current_value)
	#set($time = $current_value.toStringLocalFull())
	#set($hour = $current_value.breakdownLocal().hour)
	#set($minute = $current_value.breakdownLocal().min)
	#set($timeType = "am")
	
	#if($hour > 12)
		#set($hour = $hour - 12)
		#set($timeType = "pm")
	#elseif($hour == 12)
		#set($timeType = "pm")
	#elseif ($hour == 0)
		#set($hour = 12)
	#end
	
	<select name="${prefix}_hour${DOT}${suffix}" id="${prefix}_hour${DOT}${suffix}">
		#if($hour == 1) <option selected="selected" value="1">1</option> #else <option value="1">1</option> #end
		#if($hour == 2) <option selected="selected" value="2">2</option> #else <option value="2">2</option> #end
		#if($hour == 3) <option selected="selected" value="3">3</option> #else <option value="3">3</option> #end
		#if($hour == 4) <option selected="selected" value="4">4</option> #else <option value="4">4</option> #end
		#if($hour == 5) <option selected="selected" value="5">5</option> #else <option value="5">5</option> #end
		#if($hour == 6) <option selected="selected" value="6">6</option> #else <option value="6">6</option> #end 
		#if($hour == 7) <option selected="selected" value="7">7</option> #else <option value="7">7</option> #end
		#if($hour == 8) <option selected="selected" value="8">8</option> #else <option value="8">8</option> #end
		#if($hour == 9) <option selected="selected" value="9">9</option> #else <option value="9">9</option> #end
		#if($hour == 10) <option selected="selected" value="10">10</option> #else <option value="10">10</option> #end
		#if($hour == 11) <option selected="selected" value="11">11</option> #else <option value="11">11</option> #end
		#if($hour == 12) <option selected="selected" value="12">12</option> #else <option value="12">12</option> #end
	</select>
	<select name="${prefix}_minute${DOT}${suffix}" id="${prefix}_minute${DOT}${suffix}">
		#if($minute == 0) <option selected="selected" value="0">00</option> #else <option value="0">00</option> #end
		#if($minute == 5) <option selected="selected" value="5">05</option> #else <option value="5">05</option> #end
		#if($minute == 10) <option selected="selected" value="10">10</option> #else <option value="10">10</option> #end
		#if($minute == 15) <option selected="selected" value="15">15</option> #else <option value="15">15</option> #end
		#if($minute == 20) <option selected="selected" value="20">20</option> #else <option value="20">20</option> #end
		#if($minute == 25) <option selected="selected" value="25">25</option> #else <option value="25">25</option> #end
		#if($minute == 30) <option selected="selected" value="30">30</option> #else <option value="30">30</option> #end 
		#if($minute == 35) <option selected="selected" value="35">35</option> #else <option value="35">35</option> #end
		#if($minute == 40) <option selected="selected" value="40">40</option> #else <option value="40">40</option> #end
		#if($minute == 45) <option selected="selected" value="45">45</option> #else <option value="45">45</option> #end
		#if($minute == 50) <option selected="selected" value="50">50</option> #else <option value="50">50</option> #end
		#if($minute == 55) <option selected="selected" value="55">55</option> #else <option value="55">55</option> #end
	</select>
	<select name="${prefix}_ampm${DOT}${suffix}" id="${prefix}_ampm${DOT}${suffix}">
		#if($timeType =="am") <option selected="selected">am</option> #else <option>am</option> #end
		#if($timeType =="pm") <option selected="selected">pm</option> #else <option>pm</option> #end
	</select>
#end
##
	<p class="shorttext">
		<label for="description${DOT}$i">
			$tlang.getString("edit.descr") 
		</label>
		<textarea id="description${DOT}$i" name="description${DOT}$i" rows="5" cols="80" wrap="virtual">$!{model.description}</textarea>
	</p>
	#if($model.canSetQuota())
		<p class="shorttext">
			<label for="hasQuota${DOT}$i">
				$tlang.getString("edit.quota")
			</label>
			<span>	
				<input type="hidden" name="setQuota${DOT}$i" value="true" />
				<input type="checkbox" name="hasQuota${DOT}$i" id="hasQuota${DOT}$i" value="true"#if($model.hasQuota()) checked="checked" #end style="border:none" />
				<input type="text" size="10" name="quota${DOT}$i" id="quota${DOT}$i" value="$!model.quota" />
			</span>
		</p>	
	#end
	#if($model.resourceTypeDef.hasRightsDialog()) 
		#if ($!copyrightTypes)
			<p class="shorttext">
				<span class="reqStar">*</span>
				<label for="copyright${DOT}$i">
					$tlang.getString("cright.status")
				</label>	
				<select name="copyright${DOT}$i" id ="copyright${DOT}$i">
					#foreach ($copyright in $copyrightTypes)
						<option value="$copyright"#if($model.copyrightStatus == $copyright) selected="selected"#end>$copyright</option>
					#end
				</select>
				#if ($!fairuseurl)
					(<a href="$fairuseurl" target="_blank" title="[$tlang.getString('cright.newwin')]"><span class="skip"> [$tlang.getString('cright.newwin')]</span>$tlang.getString("cright.fairuse")</a>)
				#end
			</p>
			<div id="copyright_status${DOT}$i"#if($model.copyrightStatus == $USE_THIS_COPYRIGHT) style="display:block;"#else style="display:none;"#end>
				<p class="shorttext">
					<span class="reqStar">*</span>
					<label for="newcopyright${DOT}$i">
						$tlang.getString("cright.info")
					</label>	
					<textarea name="newcopyright${DOT}$i" id="newcopyright${DOT}$i" rows="2" cols="40" wrap="virtual" >$validator.escapeHtmlTextarea("$!model.copyrightInfo")</textarea>
				</p>	
			</div>
			<table border="0">
				<tr>
					<td style="width:180px;padding-left:1em;vertical-align:top">
						<label for="copyrightAlert${DOT}$i">
							$tlang.getString("cright.alert")
						</label>
					</td>
					<td style="vertical-align:top">
						<input type="checkbox" name="copyrightAlert${DOT}$i" id ="copyrightAlert${DOT}$i" value="true" #if($model.hasCopyrightAlert())checked="checked"#end style="border:none" />
						$tlang.getString("cright.display") 
						(<a href="#" onclick="javascript:openSampleCopyrightWindow();" title="[$tlang.getString('cright.newwin')]"><span class="skip">[$tlang.getString('cright.newwin')]</span>$tlang.getString("cright.show")</a>)
					</td>
				</tr>
			</table>
		#end
	#end

	#if(!$model.isDropbox() && ! $model.isSiteCollection())
		<h4>
			$tlang.getString("props.access")
		</h4>
	#end
	
	######### begin access section ##########
	#if(!$model.isDropbox() && ! $model.isSiteCollection())
		<p class="instruction">$model.longAccessLabel</p>
		<div  class="labelindnt">
			#set ($listDisplay="none")
			#if($model.isSiteOnly())
				##Site has *NO* groups and public-view is *NOT* enabled on the server (no choices to be made, but we should report the access)
				<input type="hidden" name="access_mode${DOT}$i" id="access_mode_hidden${DOT}$i" value="$INHERITED_ACCESS" />
			#elseif($model.isSingleGroupInherited())
				##Grouped access is inherited; parent folder limited to a single group (report that grouped access limited to a single group is inherited from above)
				<input type="hidden" name="access_mode${DOT}$i" id="access_mode_hidden${DOT}$i" value="$INHERITED_ACCESS" />
			#elseif($model.isGroupInherited() && "$model.accessMode" == "grouped")	
				##Grouped access is inherited; parent folder limited to two or more groups (present choice among groups; table shows only groups inherited from parent)
				#set ($listDisplay="block")
				<p>
					<input type="radio" name="access_mode${DOT}$i" id="access_mode_inherited${DOT}$i" value="inherit" style="border:none" />
					<label for="access_mode_inherited${DOT}$i">$tlang.getString("access.inherit")</label>
				</p>
				<p>
					<input type="radio" name="access_mode${DOT}$i" id="access_mode_groups${DOT}$i" value="$GROUP_ACCESS" checked="checked"    style="border:none" />
					<label for="access_mode_groups${DOT}$i">$tlang.getString("access.groups.choice")</label>
				</p>
			#elseif($model.isGroupInherited())	
				##Grouped access is inherited; parent folder limited to two or more groups (present choice among groups; table shows only groups inherited from parent)
				<p>
					<input type="radio" name="access_mode${DOT}$i" id="access_mode_inherited${DOT}$i" value="inherited" checked="checked"   style="border:none" />
					<label for="access_mode_inherited${DOT}$i">$tlang.getString("access.inherit")</label>
				</p>
				<p>
					<input type="radio" name="access_mode${DOT}$i" id="access_mode_groups${DOT}$i" value="$GROUP_ACCESS"   style="border:none" />
					<label for="access_mode_groups${DOT}$i">$tlang.getString("access.groups.choice")</label>
				</p>
			#elseif($model.isPubviewInherited())
				## Public access inherited from parent (report that to user)
				<input type="hidden" name="access_mode${DOT}$i" id="access_mode_hidden${DOT}$i" value="$INHERITED_ACCESS" />
			#else
				## Site is possible and either group or public is possible
				<p>
					<input type="radio" name="access_mode${DOT}$i" id="access_mode_inherited${DOT}$i" value="inherited" #if(!$model.isPubview() && "$!model.accessMode" != "$GROUP_ACCESS") checked="checked"#end style="border:none" />
					<label for="access_mode_inherited${DOT}$i">#if($model.isCollection())$tlang.getString("access.site.fldr")#else$tlang.getString("access.site.choice")#end</label>
				</p>
				#if($model.isPubviewPossible())
					## Public is possible
					<p>
						<input type="radio" name="access_mode${DOT}$i" id="access_mode_public${DOT}$i" value="public" #if($!model.isPubview()) checked="checked"#end style="border:none" />
						<label for="access_mode_public${DOT}$i">#if($model.isCollection())$tlang.getString("access.public.fldr")#else$tlang.getString("access.public.choice")#end</label>
					</p>
				#end
				#if($model.isGroupPossible())
					## Group is possible
					#if("$!model.accessMode" == "$GROUP_ACCESS")
						#set ($listDisplay="block")
					#else
						#set ($listDisplay="none")
					#end
					<p>
						<input type="radio" name="access_mode${DOT}$i" id="access_mode_groups${DOT}$i" value="$GROUP_ACCESS" #if("$!model.accessMode" == "$GROUP_ACCESS") checked="checked"#end style="border:none" />
						<label for="access_mode_groups${DOT}$i">#if($model.isCollection())$tlang.getString("access.groups.fldr")#else$tlang.getString("access.groups.choice")#end</label>
					</p>
				#end
			#end
		</div>

		#if($model.isGroupPossible())
			<table id="groupTable${DOT}$i" class="listHier lines labelindnt" border="0" style="width:80%;display:$listDisplay" cellspacing="0" summary="$tlang.getString("edit.group3")">
				<caption class="skip" style="display:none">$tlang.getString("edit.access4")</caption>
				<tr>
					<th id="selected${DOT}$i" style="width:2em;padding-left:.4em">
						<input type="checkbox" id="selectall${DOT}$i" title="toggle select all" />
					</th>
					<th id="groupname${DOT}$i">
						$tlang.getString("edit.group1")
					</th>
					<th id ="groupdescription${DOT}$i">
						$tlang.getString("edit.group2")
					</th>
				</tr>
				#set($theGroups = $model.possibleGroups)
				#foreach ($group in $!{theGroups})
					#if($model.isPossible($group))
						<tr>
							<td headers="selected${DOT}$i" style="padding-bottom:0;" style="width:2em">
								#if($model.isLocal($group) && $model.allowedRemove($group))
									<input type="checkbox" name="access_groups${DOT}$i" id="access_groups_${group.Id}${DOT}$i" title="$group.title" value="$group.Id" checked="checked" />
								#elseif($model.isLocal($group))
									<img src="#imageLink("sakai/checkon.gif")" border="0" width="17" height="13" align="top" />
								#else
									<input type="checkbox" name="access_groups${DOT}$i" id="access_groups_${group.Id}${DOT}$i" title="$group.title" value="$group.Id" />
								#end
							</td>
							<td headers="groupname${DOT}$i" style="padding-bottom:0;" class="checkbox">
								<label for="access_groups_${group.Id}${DOT}$i">
									$group.title
								</label>	
							</td>
							<td headers="groupdescription${DOT}$i" width="100%"> ##mozilla does not resize table children dynamically , so set here
								#set($description = "")
								#if($group.description)
									#set($description = $group.Description)
								#end
								$!description
							</td>
						</tr>
					#end
				#end
			</table>
		#end
	#end

	######### end access section ##########

	######### begin availability section ##########
	#if($availability_is_enabled && !$model.isUserSite() && !$model.isDropbox() && ! $model.isSiteCollection())
		<p class="instruction">
			#if($model.isCollection())
				$tlang.getString("instr.access.fldr")
			#else
				$tlang.getString("instr.access")
			#end
		</p>
		<div  class="labelindnt">
			<table>
				<tr>
					<td>
						<input type="radio" name="hidden${DOT}$i" id="hidden_false${DOT}$i" value="false" #if(!$model.isHidden())checked="checked" #end/>
					</td>
					<td colspan="4">
						<label for="hidden_false${DOT}$i">
							#if($model.isCollection())
								$tlang.getString("avail.show2")
							#else
								$tlang.getString("avail.show1")
							#end
						</label>
					</td>
				</tr>
				<tr>
					<td>
					</td>
					<td>
						<input type="checkbox" name="use_start_date${DOT}$i" id="use_start_date${DOT}$i" value="true" #if($!model.useReleaseDate())checked="checked" #end/>
					</td>
					<td colspan="3">
						<label for="use_start_date${DOT}$i">
							$tlang.getString("avail.start1")
						</label>
					</td>
				</tr>
				<tr>
					<td>
					</td>
					<td>
					</td>
					<td>
					</td>
					<td>
						<label for="release_year${DOT}$i">$tlang.getString("label.date")</label>
					</td>
					<td>
						<label for="release_hour${DOT}$i">$tlang.getString("label.time")</label>
					</td>
				</tr>
				<tr>
					<td>
					</td>
					<td>
					</td>
					<td>
					</td>
					<td>
						#resources_dateselectionwidget("release" "$i" $model.releaseDate.breakdownLocal() )
					</td>
					<td>
						#resources_timeSelectionWidget("release" "$i" $model.releaseDate)
					</td>
				</tr>
				<tr>
					<td>
					</td>
					<td>
						<input type="checkbox" name="use_end_date${DOT}$i" id="use_end_date${DOT}$i" value="true" #if($model.useRetractDate())checked="checked" #end/>
					</td>
					<td colspan="4">
						<label for="use_end_date${DOT}$i">
							$tlang.getString("avail.end1")
						</label>
					</td>
				</tr>
				<tr>
					<td>
					</td>
					<td>
					</td>
					<td>
					</td>
					<td>
						<label for="retract_year${DOT}$i">Date:</label>
					</td>
					<td>
						<label for="retract_time${DOT}$i">Time:</label>
					</td>
				</tr>
				<tr>
					<td>
					</td>
					<td>
					</td>
					<td>
					</td>
					<td>
						#resources_dateselectionwidget("retract" "$i" $model.retractDate.breakdownLocal())
					</td>
					<td>
						#resources_timeSelectionWidget("retract" "$i" $model.retractDate)
					</td>
				</tr>
				<tr>
					<td>
						<input type="radio" name="hidden${DOT}$i" id="hidden_true${DOT}$i" value="true" #if($model.isHidden())checked="checked" #end/>
					</td>
					<td colspan="4">
						<label for="hidden_true${DOT}$i">
							#if($model.isCollection())
								$tlang.getString("avail.hide20")
							#else
								$tlang.getString("avail.hide10")
							#end
						</label>
					</td>
				</tr>
			</table>
		</div>
	#end
	######### end availability section ##########	
	
	#if($showItemSummary)
		<h4>
			#if($item.isCollection())
				$tlang.getString("props.fldr")
			#else
				$tlang.getString("props.file")
			#end
		</h4>
	
		<table class="itemSummary" border="0" style="clear:both;margin:left:.7em">
			#if (!($dropboxMode && $collectionId==$homeCollectionId))
				<tr> 
					<td style="width:180px;padding-left:.7em"> 
						<label>#if("$!TYPE_UPLOAD" == "$!{type.id}")$tlang.getString("props.creator.upl")#else$tlang.getString("props.creator")#end</label>
					</td>
					<td>
						$validator.escapeHtml("$model.createdBy")
					</td>
				</tr>
				<tr> 
					<td style="width:180px;padding-left:.7em"> 
						<label>#if("$!TYPE_UPLOAD" == "$!{type.id}")$tlang.getString("props.creatime.upl")#else$tlang.getString("props.creatime")#end</label>
					</td>
					<td>
						$validator.escapeHtml("$model.createdTime")
					</td>
				</tr>
			#end
			<tr>
				<td style="width:180px;padding-left:.7em"> 
					<label>$tlang.getString("props.modby")</label>
				</td>
				<td>
					$validator.escapeHtml("$model.modifiedBy")
				</td>
			</tr>
			<tr> 
				<td style="width:180px;padding-left:.7em"> 
					<label>$tlang.getString("props.modtime")</label>
				</td>
				<td>
					$validator.escapeHtml("$model.modifiedTime")
				</td>
			</tr>
			<tr> 
				<td  style="width:180px;padding-left:.7em"> 
					<label>$tlang.getString("props.url")</label>
				</td>
				<td>
					<a href="$model.accessUrl" target="$model.target">$model.accessUrl</a>
				</td>
			</tr>
			#if(! $item.isCollection())
				<tr> 
					<td  style="width:180px;padding-left:.7em"> 
						<label>$tlang.getString("props.size")</label>
					</td>
					<td>
						$model.sizzle 
					</td>
				</tr>
			#end
			#if(! $model.isUrl() && ! $model.isCollection() && "$!{model.mimetype}" != "")
				<tr> 
					<td style="width:180px;padding-left:.7em"> 
						<label>$tlang.getString("props.mime")</label>
					</td>
					<td>
						<span id="mime_warning${DOT}$i"></span>
						<span id="mime_widget${DOT}$i">
							$model.mimetype
							<input type="hidden" name="mime_category${DOT}$i" id="mime_category${DOT}$i" value="$model.mimeCategory" />  
							<input type="hidden" name="mime_subtype${DOT}$i" id="mime_subtype${DOT}$i" value="$model.mimeSubtype" />
							<input type="button" name="changeMimetype${DOT}$i" id="changeMimetype${DOT}$i" value="Change File Type" />
						</span>
					</td>
				</tr>
			#end
			#if ($showMountPointProperty)
				<tr>
					<td>$tlang.getString("props.mountpoint")</td>
                    <td><input type="textbox" name="sakai:handler-bean-id" id="sakai:handler-bean-id" value="$CHHmountpoint" /></td>
				</tr>
			#end
		</table> 
	#end
#parse("/vm/resources/sakai_metadata-edit.vm")
